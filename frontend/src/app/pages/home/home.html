<h2 class="title">Your folders</h2>

<div class="grid">
  <mat-card class="folder-card" role="button" (click)="addFolder()">
    <mat-icon class="folder-icon folder-add" fontIcon="add"></mat-icon>
  </mat-card>

  <mat-card
    class="folder-card"
    *ngFor="let f of folders$ | async"
    role="button"
    (click)="openFolder(f.id)"
  >
    <div class="card-actions">
      <button
        mat-icon-button
        class="icon-btn"
        aria-label="Rename folder"
        (click)="startEdit(f); $event.stopPropagation()"
        title="Rename folder"
      >
        <mat-icon fontIcon="edit"></mat-icon>
      </button>

      <button
        mat-icon-button
        class="icon-btn"
        aria-label="Delete folder"
        (click)="onDelete(f.id); $event.stopPropagation()"
        title="Delete folder"
      >
        <fa-icon [icon]="faTrash"></fa-icon>
      </button>
    </div>

    <ng-container *ngIf="f.icon; else defaultIcon">
      <mat-icon class="folder-icon" [fontIcon]="f.icon"></mat-icon>
    </ng-container>
    <ng-template #defaultIcon>
      <mat-icon class="folder-icon" fontIcon="folder"></mat-icon>
    </ng-template>

    <div class="name" *ngIf="editingId !== f.id; else editNameTpl">
      {{ f.name }}
    </div>

    <ng-template #editNameTpl>
      <input
        #nameInput
        class="name-input"
        [ngModel]="editValue"
        (ngModelChange)="editValue = $event"
        (click)="$event.stopPropagation()"
        (keydown.enter)="commitEdit(f)"
        (keydown.escape)="cancelEdit()"
        (blur)="commitEdit(f)"
      />
    </ng-template>
  </mat-card>
</div>
