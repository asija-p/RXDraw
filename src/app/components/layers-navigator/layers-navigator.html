<div class="container">
  <div class="layer-buttons">
    <button
      class="button layer-btn"
      (click)="addNewLayer()"
      aria-label="Add layer"
      title="Add layer"
    >
      +
    </button>

    <button
      class="button layer-btn"
      (click)="removeSelected()"
      aria-label="Delete layer"
      title="Delete layer"
    >
      <fa-icon [icon]="faTrash" size="lg"></fa-icon>
    </button>
  </div>

  <div *ngIf="activeLayer$ | async as active">
    <div
      class="opacity-wrap"
      role="progressbar"
      [attr.aria-valuemin]="0"
      [attr.aria-valuemax]="100"
      [attr.aria-valuenow]="active.opacity * 100"
    >
      <div class="opacity-fill" [style.width.%]="active.opacity * 100"></div>
    </div>
    <div class="opacity-label">Opacity: {{ active.opacity * 100 }}%</div>
  </div>

  <div class="layers">
    <div
      class="layer"
      *ngFor="let l of layers$ | async; trackBy: trackById"
      (click)="selectLayer(l.id)"
      [class.active]="l.id === (activeLayer$ | async)?.id"
    >
      <span class="name">{{ l.name }}</span>
      <button
        type="button"
        class="icon-btn"
        (click)="onToggleVisible(l.id, l.visible); $event.stopPropagation()"
        [attr.aria-pressed]="l.visible"
        [title]="l.visible ? 'Hide layer' : 'Show layer'"
      >
        <fa-icon [icon]="l.visible ? faEye : faEyeSlash"></fa-icon>
      </button>
    </div>
  </div>
</div>
